#!/bin/bash

SESSION_NAME="${2:-dev}"
WORK_DIR="${1:-$PWD}"

# Kill existing session if it exists
tmux kill-session -t "$SESSION_NAME" 2>/dev/null

# Create new session with first window
tmux new-session -d -s "$SESSION_NAME" -c "$WORK_DIR"

# Split first window vertically (top/bottom)
tmux split-window -v -t "$SESSION_NAME:0" -c "$WORK_DIR"

# Create second window with single pane
tmux new-window -t "$SESSION_NAME" -c "$WORK_DIR"

# Select the first window
tmux select-window -t "$SESSION_NAME:0"

# Select the first pane of the first window
tmux select-pane -t "$SESSION_NAME:0.0"

## Launch neovim after attach (in background so attach happens first)
#tmux send-keys -t "$SESSION_NAME:0.0" "nvim" Enter

# Attach to session
tmux attach-session -t "$SESSION_NAME"
